## Tools Required
- pestudio
- CFF explorer

## Different type of Packers

|-----------|------------|-----------|
| Free and Easiest | Malware and Regular | Commertial and Difficult |
|------------------|---------------------|--------------------------|
| UPX | Warzone Crypter | Yakuza Crypter | VMProtect |
| nPack | Atilla Crypter | Themida |
| MEW | AspireCrypt | Obsidium | 
| PolyCryptor | Spartan Crypter | Armadillo | 
| MPRESS | Emotet, Dridex, ISFB, Trickbot | ASPack |
| PE Protector |  | PELock |



## Detecting Packed Malware
 - **Signature:** Tools like *PEID*, YaraScan, etc. can pick up signatures and detect based on rules. Signatures range from values to byte patterns.
 - **Strings:** A lack of strings (or an abundance of nonsensical strings) in the binary could be an idicator; the program is packed in some way.
 - **Section Names:** Packers commonly add extra sections to the binary, such as UPX. These names could be named after the packers, or be completly random.
 - **Entropy:** The entropy is determined by the frequency of recurring bytes - the higher the entropy, the lower the amount of recurring bytes - this usually indicates the data is encrypted.
 - **Raw/Virtual Sizes:** Raw section sizes signify the size of sections while not running, while the vitual sizes are opposite. Noticable difference between the two could indicate the sample is packed.
 
 
 
 ## Common Packer functionality
 A malware is developed and is passed to the packer for packing it. The packer packs up the binary and adds a new section to unpack the binary. 
 This unpacker is going to Allocate some process memory and will copy a shellcode(might be present in clear text or in encrypted format) into that memory region.
 The unpacker will then pass the execution to shellcode. The shellcode will again allocate some memory in process space. The shellcode will then decrypt the executable and will place it in memory. and will start executing by using varios execution techniques.
 
 
 
 ## Methods of unpacking common packers
 
 |--------------------------|-------------------------|---------------------------|
 | Statically and Difficult | Dynamically and Regular | Automatically and easiest |
 |--------------------------|-------------------------|---------------------------|
 | Reverse Engineering entire unpacking routine: Algo, Egg hunting, parsing EXE and shellcode | Using a debugger to place breakpoints on common unpacking functions: VirtualProtect(Ex), VirtualAlloc(Ex), WriteProcessMemory, etc | Automated softwware either online or local: Unpac.me, PE-Sieve, Sandboxes, etc. |
